!function e(t,i,s){function r(a,o){if(!i[a]){if(!t[a]){var h="function"==typeof require&&require;if(!o&&h)return h(a,!0);if(n)return n(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=i[a]={exports:{}};t[a][0].call(l.exports,function(e){var i=t[a][1][e];return r(i?i:e)},l,l.exports,e,t,i,s)}return i[a].exports}for(var n="function"==typeof require&&require,a=0;a<s.length;a++)r(s[a]);return r}({1:[function(e,t,i){"use strict";var s={IMAGES:{title_bg:"image/title_bg.png",prologue_bg:"image/prologue_bg.jpg",renko_normal:"image/renko_normal.jpg",merry_normal:"image/merry_normal.jpg",ganger_normal:"image/ganger_normal.jpg"},SOUNDS:{select:{id:1,path:"sound/select.wav",volume:.8}},BGMS:{title:{path:"bgm/title.mp3",volume:.4},prologue:{path:"bgm/prologue.mp3",volume:.4}},MESSAGE_SPEED:10,PROLOGUE_LEFT_X:20,PROLOGUE_LEFT_Y:130,PROLOGUE_RIGHT_X:350,PROLOGUE_RIGHT_Y:130,CHARA:{ganger:{name:"？？？"},renko:{name:"蓮子"},merry:{name:"メリー"}}};s.ALL_MATERIAL_NUM=Object.keys(s.IMAGES).length+Object.keys(s.SOUNDS).length+Object.keys(s.BGMS).length,t.exports=s},{}],2:[function(e,t,i){"use strict";var s={DEBUG:!0,LOADING_SCENE:0,TITLE_SCENE:1,PROLOGUE_SCENE:2,STAGE_SCENE:3,EPILOGUE_SCENE:4,ENDING_SCENE:5,BUTTON_LEFT:1,BUTTON_UP:2,BUTTON_RIGHT:4,BUTTON_DOWN:8,BUTTON_Z:16,BUTTON_X:32,BUTTON_SHIFT:64,BUTTON_SPACE:128};t.exports=s},{}],3:[function(e,t,i){"use strict";var s=e("./config"),r=e("./constant"),n=e("./scene/loading"),a=e("./scene/title"),o=e("./scene/prologue"),h=function(e){this.surface=e.getContext("2d"),this.width=Number(e.getAttribute("width")),this.height=Number(e.getAttribute("height")),this.state=null,this.scenes=[],this.scenes[r.LOADING_SCENE]=new n(this),this.scenes[r.TITLE_SCENE]=new a(this),this.scenes[r.PROLOGUE_SCENE]=new o(this),this.images={},this.sounds={},this.bgms={},this.soundflag=0,this.frame_count=0,this.keyflag=0,this.before_keyflag=0};h.prototype={init:function(){this.frame_count=0,this.keyflag=0,this.before_keyflag=0,this.changeScene(r.LOADING_SCENE)},handleKeyDown:function(e){this.keyflag|=this._keyCodeToBitCode(e.keyCode),e.preventDefault()},handleKeyUp:function(e){this.keyflag&=~this._keyCodeToBitCode(e.keyCode),e.preventDefault()},isKeyDown:function(e){return this.keyflag&e},isKeyPush:function(e){return!(this.before_keyflag&e)&&this.keyflag&e},_keyCodeToBitCode:function(e){var t;switch(e){case 16:t=r.BUTTON_SHIFT;break;case 32:t=r.BUTTON_SPACE;break;case 37:t=r.BUTTON_LEFT;break;case 38:t=r.BUTTON_UP;break;case 39:t=r.BUTTON_RIGHT;break;case 40:t=r.BUTTON_DOWN;break;case 88:t=r.BUTTON_X;break;case 90:t=r.BUTTON_Z}return t},changeScene:function(e){this.state=e,this.currentScene().init()},playBGM:function(e){for(var t in this.bgms)this.bgms[t].pause(),this.bgms[t].currentTime=0;this.bgms[e].loop=!0,this.bgms[e].play()},playSound:function(e){this.soundflag|=s.SOUNDS[e].id},runPlaySound:function(){for(var e in s.SOUNDS)if(this.soundflag&s.SOUNDS[e].id){this.sounds[e].pause(),this.sounds[e].currentTime=0,this.sounds[e].play(),this.soundflag&=~s.SOUNDS[e].id;break}},getImage:function(e){return this.images[e]},currentScene:function(){return this.scenes[this.state]},run:function(){this.currentScene().run(),this.currentScene().updateDisplay(),this.runPlaySound(),this.before_keyflag=this.keyflag,this.frame_count++,requestAnimationFrame(this.run.bind(this))},notifyLoadingDone:function(){this.changeScene(r.TITLE_SCENE)},notifyTitleDone:function(){this.changeScene(r.PROLOGUE_SCENE)},notifyPrologueDone:function(){this.changeScene(r.STAGE_SCENE)}},t.exports=h},{"./config":1,"./constant":2,"./scene/loading":7,"./scene/prologue":8,"./scene/title":9}],4:[function(e,t,i){"use strict";var s=e("../config"),r=function(e){this.timeoutID=null,this.script=e,this.progress=null,this.left_chara_id=null,this.left_exp=null,this.right_chara_id=null,this.right_exp=null,this.pos=null,this.line_num=0,this.printing_lines=[]};r.prototype.init=function(){this.progress=-1,this.timeoutID=null,this.left_chara_id=null,this.left_exp=null,this.right_chara_id=null,this.right_exp=null,this.pos=null,this.line_num=0,this.printing_lines=[],this.next()},r.prototype.is_end=function(){return this.progress+1===this.script.length},r.prototype.next=function(){this.progress++;var e=this.script[this.progress];this._showChara(e),e.serif?this._printMessage(e.serif):this.next()},r.prototype._showChara=function(e){e.pos&&(this.pos=e.pos,"left"===e.pos?(this.left_chara_id=e.chara,this.left_exp=e.exp):"right"===e.pos&&(this.right_chara_id=e.chara,this.right_exp=e.exp))},r.prototype._printMessage=function(e){var t=this;null!==t.timeoutID&&(clearTimeout(t.timeoutID),t.timeoutID=null);var i=e.split(""),r=i.length,n=0;t.line_num=0,t.printing_lines=[];var a=function(){if(!(n>=r)){var e=s.MESSAGE_SPEED,o=i[n];n++,"\n"===o?t.line_num++:(t.printing_lines[t.line_num]||(t.printing_lines[t.line_num]=""),t.printing_lines[t.line_num]=t.printing_lines[t.line_num]+o),t.timeoutID=setTimeout(a,e)}};a()},r.prototype.right_image=function(){return this.right_chara_id?this.right_chara_id+"_"+this.right_exp:null},r.prototype.left_image=function(){return this.left_chara_id?this.left_chara_id+"_"+this.left_exp:null},r.prototype.text_name=function(){return this.is_left_talking()?s.CHARA[this.left_chara_id].name:this.is_right_talking()?s.CHARA[this.right_chara_id].name:void 0},r.prototype.is_left_talking=function(){return"left"===this.pos?!0:!1},r.prototype.is_right_talking=function(){return"right"===this.pos?!0:!1},r.prototype.lines=function(){return this.printing_lines},t.exports=r},{"../config":1}],5:[function(e,t,i){"use strict";var s=e("./game");window.onload=function(){var e=document.getElementById("mainCanvas"),t=new s(e);t.init(),window.onkeydown=function(e){t.handleKeyDown(e)},window.onkeyup=function(e){t.handleKeyUp(e)},t.run()}},{"./game":3}],6:[function(e,t,i){"use strict";var s=function(e){this.game=e,this.frame_count=0};s.prototype.init=function(){this.frame_count=0},s.prototype.handleKeyDown=function(e){},s.prototype.handleKeyUp=function(e){},s.prototype.run=function(){this.frame_count++},s.prototype.updateDisplay=function(){console.error("updateDisplay method must be overridden")},t.exports=s},{}],7:[function(e,t,i){"use strict";var s=e("../util"),r=e("../config"),n=e("./base"),a=function(e){n.apply(this,arguments),this.loadedImageNum=0,this.loadedSoundNum=0,this.loadedBGMNum=0};s.inherit(a,n),a.prototype.init=function(){this._loadImages(),this._loadSounds(),this._loadBGMs()},a.prototype.loaded_material_num=function(){return this.loadedImageNum+this.loadedSoundNum+this.loadedBGMNum},a.prototype.run=function(){this.loaded_material_num()>=r.ALL_MATERIAL_NUM&&this.game.notifyLoadingDone()},a.prototype.updateDisplay=function(){var e=r.ALL_MATERIAL_NUM,t=this.loaded_material_num();this.game.surface.save(),this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.textAlign="right",this.game.surface.font="30px 'Comic Sans MS'",this.game.surface.fillText("Now Loading...",400,225),this.game.surface.fillText(t+"/"+e,400,285),this.game.surface.restore()},a.prototype._loadImages=function(){var e,t=this,i=function(){t.loadedImageNum++};for(var s in r.IMAGES)e=new Image,e.src=r.IMAGES[s],e.onload=i,this.game.images[s]=e},a.prototype._loadSounds=function(){var e,t,i=this,s=function(){i.loadedBGMNum++};for(var n in r.SOUNDS)e=r.SOUNDS[n],t=new Audio(e.path),t.volume=e.volume,t.addEventListener("canplay",s),t.load(),this.game.sounds[n]=t},a.prototype._loadBGMs=function(){var e,t,i=this,s=function(){i.loadedBGMNum++};for(var n in r.BGMS)e=r.BGMS[n],t=new Audio(e.path),t.volume=e.volume,t.addEventListener("canplay",s),t.load(),this.game.bgms[n]=t},t.exports=a},{"../config":1,"../util":11,"./base":6}],8:[function(e,t,i){"use strict";var s=e("./base"),r=e("../util"),n=e("../constant"),a=e("../config"),o=e("../serif/prologue"),h=e("../logic/serif"),u=function(e){s.apply(this,arguments),this.serif=new h(o)};r.inherit(u,s),u.prototype.init=function(){s.prototype.init.apply(this,arguments),this.serif.init(),this.game.playBGM("prologue")},u.prototype.run=function(){s.prototype.run.apply(this,arguments),this.game.isKeyPush(n.BUTTON_Z)&&(this.serif.is_end()?this.game.notifyPrologueDone():this.serif.next())},u.prototype.updateDisplay=function(){this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.save();var e=this.game.getImage("prologue_bg");if(this.game.surface.drawImage(e,0,0,e.width,e.height,0,0,this.game.width,this.game.height),this.game.surface.restore(),this.serif.right_image()){this.game.surface.save(),this.serif.is_right_talking()||(this.game.surface.globalAlpha=.5);var t=this.game.getImage(this.serif.right_image());this.game.surface.drawImage(t,a.PROLOGUE_RIGHT_X,a.PROLOGUE_RIGHT_Y,.25*t.width,.25*t.height),this.game.surface.restore()}if(this.serif.left_image()){this.game.surface.save(),this.serif.is_left_talking()||(this.game.surface.globalAlpha=.5);var i=this.game.getImage(this.serif.left_image());this.game.surface.drawImage(i,a.PROLOGUE_LEFT_X,a.PROLOGUE_LEFT_Y,.5*i.width,.5*i.height),this.game.surface.restore()}this.game.surface.save(),this.game.surface.globalAlpha=.5,this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.fillRect(5,345,630,125),this.game.surface.restore(),this.game.surface.save(),this.game.surface.globalAlpha=.5,this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.fillRect(5,305,100,40),this.game.surface.restore(),this.game.surface.save(),this.game.surface.font="24px 'Comic Sans MS'",this.game.surface.textAlign="left",this.game.surface.textBaseAlign="middle",this.game.surface.fillStyle="rgb( 255, 255, 255 )",this.serif.text_name()&&this.game.surface.fillText(this.serif.text_name(),15,340);var s=this.serif.lines();if(s.length)for(var r=380,n=0,o=s.length;o>n;n++)this.game.surface.fillText(s[n],15,r),r+=30;this.game.surface.restore()},t.exports=u},{"../config":1,"../constant":2,"../logic/serif":4,"../serif/prologue":10,"../util":11,"./base":6}],9:[function(e,t,i){"use strict";var s=e("./base"),r=e("../util"),n=e("../constant"),a=100,o=50,h=function(e){s.apply(this,arguments)};r.inherit(h,s),h.prototype.init=function(){s.prototype.init.apply(this,arguments)},h.prototype.run=function(){s.prototype.run.apply(this,arguments),this.game.isKeyPush(n.BUTTON_Z)&&(this.game.playSound("select"),this.game.notifyTitleDone())},h.prototype.updateDisplay=function(){this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.save(),this.frame_count<a?this.game.surface.globalAlpha=this.frame_count/a:this.game.surface.globalAlpha=1;var e=this.game.getImage("title_bg");this.game.surface.drawImage(e,0,0,e.width,e.height,0,0,this.game.width,this.game.height),this.game.surface.font="24px 'Comic Sans MS'",this.game.surface.textAlign="center",this.game.surface.textBaseAlign="middle",this.game.surface.fillStyle="rgb( 0, 0, 0 )",Math.floor(this.frame_count/o)%2===0&&this.game.surface.fillText("Press Z to Start",450,350),this.game.surface.restore()},t.exports=h},{"../constant":2,"../util":11,"./base":6}],10:[function(e,t,i){"use strict";var s=[{serif:"今日は8月31日。",chara:null,pos:null,exp:null},{serif:null,chara:"ganger",pos:"right",exp:"normal"},{serif:null,chara:"renko",pos:"left",exp:"normal"},{serif:"約束を守りなさい。早く博霊神社に行かないと。",chara:"ganger",pos:"right",exp:"normal"},{serif:"え、そんな約束してたっけ？",chara:"renko",pos:"left",exp:"normal"},{serif:null,chara:"merry",pos:"right",exp:"normal"},{serif:"どうしたの？",chara:"merry",pos:"right",exp:"normal"},{serif:"実はかくかくしかじかで",chara:"renko",pos:"left",exp:"normal"},{serif:"ふーん",chara:"merry",pos:"right",exp:"normal"},{serif:"約束といえば、前に博霊神社の入り口を\n調べようって約束してたわね。",chara:"renko",pos:"left",exp:"normal"},{serif:"そうだっけ？",chara:"renko",pos:"left",exp:"normal"},{serif:"なんだか気になるわ。ねえ、今から行ってみない？",chara:"renko",pos:"left",exp:"normal"},{serif:"今から！？面倒だわ…。",chara:"merry",pos:"right",exp:"normal"},{serif:"そんな事言わずに行きましょうよ。",chara:"renko",pos:"left",exp:"normal"},{serif:"うっ…急にめまいとフラつきと腹痛と頭痛が",chara:"merry",pos:"right",exp:"normal"},{serif:"さっきまで元気だったじゃない！",chara:"renko",pos:"left",exp:"normal"},{serif:"うーん、気が進まないわ。",chara:"merry",pos:"right",exp:"normal"},{serif:"はぁ…。そんなに嫌なら仕方ないわね。\n私一人で行ってくるわ。",chara:"renko",pos:"left",exp:"normal"}];t.exports=s},{}],11:[function(e,t,i){"use strict";var s={inherit:function(e,t){var i=function(e){if(Object.create)return Object.create(e);var t=function(){};return t.prototype=e,new t};e.prototype=i(t.prototype),e.prototype.constructor=e}};t.exports=s},{}]},{},[5]);