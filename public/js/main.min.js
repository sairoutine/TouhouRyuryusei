!function e(t,i,s){function a(n,o){if(!i[n]){if(!t[n]){var h="function"==typeof require&&require;if(!o&&h)return h(n,!0);if(r)return r(n,!0);var u=new Error("Cannot find module '"+n+"'");throw u.code="MODULE_NOT_FOUND",u}var l=i[n]={exports:{}};t[n][0].call(l.exports,function(e){var i=t[n][1][e];return a(i?i:e)},l,l.exports,e,t,i,s)}return i[n].exports}for(var r="function"==typeof require&&require,n=0;n<s.length;n++)a(s[n]);return a}({1:[function(e,t,i){"use strict";var s={IMAGES:{title_bg:"image/title_bg.png",prologue1_1_bg:"image/prologue_bg.png",prologue2_bg:"image/prologue_bg.png",renko_normal:"image/renko_normal.png",merry_normal:"image/merry_normal.png",aya_normal:"image/aya_normal.png",ganger_normal:"image/ganger_normal.png",logo:"image/logo.png",fukidashi_normal:"image/serif.png"},SOUNDS:{select:{id:1,path:"sound/select.wav",volume:.8}},BGMS:{title:{path:"bgm/title.mp3",volume:.4},prologue1:{path:"bgm/prologue.mp3",volume:.4},prologue2:{path:"bgm/prologue.mp3",volume:.4}},MESSAGE_SPEED:10,PROLOGUE2_LEFT_X:0,PROLOGUE2_LEFT_Y:132,PROLOGUE2_RIGHT_X:283,PROLOGUE2_RIGHT_Y:132,PROLOGUE2_SERIF_WINDOW_X:80,PROLOGUE2_SERIF_WINDOW_Y:0,CHARA:{ganger:{name:"？？？"},renko:{name:"蓮子"},merry:{name:"メリー"}}};s.ALL_MATERIAL_NUM=Object.keys(s.IMAGES).length+Object.keys(s.SOUNDS).length+Object.keys(s.BGMS).length,t.exports=s},{}],2:[function(e,t,i){"use strict";var s={DEBUG:!0,LOADING_SCENE:0,TITLE_SCENE:1,PROLOGUE1_SCENE:2,PROLOGUE2_SCENE:3,STAGE_SCENE:4,EPILOGUE_SCENE:5,ENDING_SCENE:6,BUTTON_LEFT:1,BUTTON_UP:2,BUTTON_RIGHT:4,BUTTON_DOWN:8,BUTTON_Z:16,BUTTON_X:32,BUTTON_SHIFT:64,BUTTON_SPACE:128};t.exports=s},{}],3:[function(e,t,i){"use strict";var s,a=e("./config"),r=e("./constant"),n=e("./scene/loading"),o=e("./scene/title"),h=e("./scene/prologue1"),u=e("./scene/prologue2"),l=function(e){this.surface=e.getContext("2d"),this.width=Number(e.getAttribute("width")),this.height=Number(e.getAttribute("height")),this.state=null,this.scenes=[],this.scenes[r.LOADING_SCENE]=new n(this),this.scenes[r.TITLE_SCENE]=new o(this),this.scenes[r.PROLOGUE1_SCENE]=new h(this),this.scenes[r.PROLOGUE2_SCENE]=new u(this),this.images={},this.sounds={},this.bgms={},this.soundflag=0,this.frame_count=0,this.keyflag=0,this.before_keyflag=0};l.prototype={init:function(){this.frame_count=0,this.keyflag=0,this.before_keyflag=0,this.changeScene(r.LOADING_SCENE)},handleKeyDown:function(e){this.keyflag|=this._keyCodeToBitCode(e.keyCode),e.preventDefault()},handleKeyUp:function(e){this.keyflag&=~this._keyCodeToBitCode(e.keyCode),e.preventDefault()},isKeyDown:function(e){return this.keyflag&e},isKeyPush:function(e){return!(this.before_keyflag&e)&&this.keyflag&e},_keyCodeToBitCode:function(e){var t;switch(e){case 16:t=r.BUTTON_SHIFT;break;case 32:t=r.BUTTON_SPACE;break;case 37:t=r.BUTTON_LEFT;break;case 38:t=r.BUTTON_UP;break;case 39:t=r.BUTTON_RIGHT;break;case 40:t=r.BUTTON_DOWN;break;case 88:t=r.BUTTON_X;break;case 90:t=r.BUTTON_Z}return t},changeScene:function(e){this.state=e,this.currentScene().init()},playBGM:function(e){for(var t in this.bgms)this.bgms[t].pause(),this.bgms[t].currentTime=0;this.bgms[e].loop=!0,this.bgms[e].play()},playSound:function(e){this.soundflag|=a.SOUNDS[e].id},runPlaySound:function(){for(var e in a.SOUNDS)if(this.soundflag&a.SOUNDS[e].id){this.sounds[e].pause(),this.sounds[e].currentTime=0,this.sounds[e].play(),this.soundflag&=~a.SOUNDS[e].id;break}},getImage:function(e){return this.images[e]},currentScene:function(){return this.scenes[this.state]},run:function(){this.currentScene().run(),this.currentScene().updateDisplay(),this.runPlaySound(),this.before_keyflag=this.keyflag,this.frame_count++,requestAnimationFrame(this.run.bind(this))},notifyLoadingDone:function(){this.changeScene(r.DEBUG&&s?s:r.TITLE_SCENE)},notifyTitleDone:function(){this.changeScene(r.PROLOGUE1_SCENE)},notifyPrologue1Done:function(){this.changeScene(r.PROLOGUE2_SCENE)},notifyPrologue2Done:function(){this.changeScene(r.STAGE_SCENE)}},t.exports=l},{"./config":1,"./constant":2,"./scene/loading":7,"./scene/prologue1":8,"./scene/prologue2":9,"./scene/title":10}],4:[function(e,t,i){"use strict";var s=e("../config"),a=function(e){this.timeoutID=null,this.script=e,this.progress=null,this.left_chara_id=null,this.left_exp=null,this.right_chara_id=null,this.right_exp=null,this.pos=null,this.fukidashi=null,this.line_num=0,this.printing_lines=[]};a.prototype.init=function(){this.progress=-1,this.timeoutID=null,this.left_chara_id=null,this.left_exp=null,this.right_chara_id=null,this.right_exp=null,this.pos=null,this.fukidashi=null,this.line_num=0,this.printing_lines=[],this.next()},a.prototype.is_end=function(){return this.progress+1===this.script.length},a.prototype.next=function(){this.progress++;var e=this.script[this.progress];this._showChara(e),e.serif?this._printMessage(e.serif):this.next()},a.prototype._showChara=function(e){e.pos&&(this.pos=e.pos,this.fukidashi=e.fukidashi,"left"===e.pos?(this.left_chara_id=e.chara,this.left_exp=e.exp):"right"===e.pos&&(this.right_chara_id=e.chara,this.right_exp=e.exp))},a.prototype._printMessage=function(e){var t=this;null!==t.timeoutID&&(clearTimeout(t.timeoutID),t.timeoutID=null);var i=e.split(""),a=i.length,r=0;t.line_num=0,t.printing_lines=[];var n=function(){if(!(r>=a)){var e=s.MESSAGE_SPEED,o=i[r];r++,"\n"===o?t.line_num++:(t.printing_lines[t.line_num]||(t.printing_lines[t.line_num]=""),t.printing_lines[t.line_num]=t.printing_lines[t.line_num]+o),t.timeoutID=setTimeout(n,e)}};n()},a.prototype.right_image=function(){return this.right_chara_id?this.right_chara_id+"_"+this.right_exp:null},a.prototype.left_image=function(){return this.left_chara_id?this.left_chara_id+"_"+this.left_exp:null},a.prototype.right_name=function(){return this.right_chara_id?s.CHARA[this.right_chara_id].name:null},a.prototype.left_name=function(){return this.left_chara_id?s.CHARA[this.left_chara_id].name:null},a.prototype.serif_window=function(){return this.fukidashi?"fukidashi_"+this.fukidashi:null},a.prototype.is_left_talking=function(){return"left"===this.pos?!0:!1},a.prototype.is_right_talking=function(){return"right"===this.pos?!0:!1},a.prototype.lines=function(){return this.printing_lines},t.exports=a},{"../config":1}],5:[function(e,t,i){"use strict";var s=e("./game");window.onload=function(){var e=document.getElementById("mainCanvas"),t=new s(e);t.init(),window.onkeydown=function(e){t.handleKeyDown(e)},window.onkeyup=function(e){t.handleKeyUp(e)},t.run()}},{"./game":3}],6:[function(e,t,i){"use strict";var s=function(e){this.game=e,this.frame_count=0};s.prototype.init=function(){this.frame_count=0},s.prototype.handleKeyDown=function(e){},s.prototype.handleKeyUp=function(e){},s.prototype.run=function(){this.frame_count++},s.prototype.updateDisplay=function(){console.error("updateDisplay method must be overridden")},t.exports=s},{}],7:[function(e,t,i){"use strict";var s=e("../util"),a=e("../config"),r=e("./base"),n=function(e){r.apply(this,arguments),this.loadedImageNum=0,this.loadedSoundNum=0,this.loadedBGMNum=0};s.inherit(n,r),n.prototype.init=function(){this._loadImages(),this._loadSounds(),this._loadBGMs()},n.prototype.loaded_material_num=function(){return this.loadedImageNum+this.loadedSoundNum+this.loadedBGMNum},n.prototype.run=function(){this.loaded_material_num()>=a.ALL_MATERIAL_NUM&&this.game.notifyLoadingDone()},n.prototype.updateDisplay=function(){var e=a.ALL_MATERIAL_NUM,t=this.loaded_material_num();this.game.surface.save(),this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.textAlign="right",this.game.surface.font="30px 'Migu'",this.game.surface.fillText("Now Loading...",400,225),this.game.surface.fillText(t+"/"+e,400,285),this.game.surface.restore()},n.prototype._loadImages=function(){var e,t=this,i=function(){t.loadedImageNum++};for(var s in a.IMAGES)e=new Image,e.src=a.IMAGES[s],e.onload=i,this.game.images[s]=e},n.prototype._loadSounds=function(){var e,t,i=this,s=function(){i.loadedBGMNum++};for(var r in a.SOUNDS)e=a.SOUNDS[r],t=new Audio(e.path),t.volume=e.volume,t.addEventListener("canplay",s),t.load(),this.game.sounds[r]=t},n.prototype._loadBGMs=function(){var e,t,i=this,s=function(){i.loadedBGMNum++};for(var r in a.BGMS)e=a.BGMS[r],t=new Audio(e.path),t.volume=e.volume,t.addEventListener("canplay",s),t.load(),this.game.bgms[r]=t},t.exports=n},{"../config":1,"../util":12,"./base":6}],8:[function(e,t,i){"use strict";var s=function(){}.toString().match(/[^]*\/\*([^]*)\*\/\}$/)[1],a=300,r=20,n=50,o=24,h=6,u=e("./base"),l=e("../util"),g=e("../constant"),f=(e("../config"),function(e){u.apply(this,arguments)});l.inherit(f,u),f.prototype.init=function(){u.prototype.init.apply(this,arguments)},f.prototype.run=function(){u.prototype.run.apply(this,arguments),(a<this.frame_count||this.game.isKeyPush(g.BUTTON_Z))&&this.game.notifyPrologue1Done()},f.prototype.updateDisplay=function(){this.game.surface.clearRect(0,0,this.game.width,this.game.height);var e=this.game.getImage("prologue1_1_bg");this.game.surface.drawImage(e,0,0,e.width,e.height,0,0,this.game.width,this.game.height),this.game.surface.save(),this.game.surface.globalAlpha=.5,this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.fillRect(r,r,this.game.width-2*r,this.game.height-2*r),this.game.surface.restore(),this.game.surface.save();var t=1;if(this.frame_count<a/3?t=3*this.frame_count/a:a/3<this.frame_count&&this.frame_count<2*a/3?t=1:2*a/3<this.frame_count&&(t=3*(a-this.frame_count)/a),this.game.surface.globalAlpha=t,a>this.frame_count){this.game.surface.font=o+"px 'Migu'",this.game.surface.textBaseAlign="middle",this.game.surface.fillStyle="rgb( 255, 255, 255 )";var i=s.split("\n");if(i.length)for(var u=n,l=0,g=i.length;g>l;l++)this.game.surface.fillText(i[l],n,u),u+=o+h}this.game.surface.restore()},t.exports=f},{"../config":1,"../constant":2,"../util":12,"./base":6}],9:[function(e,t,i){"use strict";var s=.5,a=5,r=e("./base"),n=e("../util"),o=e("../constant"),h=e("../config"),u=e("../serif/prologue2"),l=e("../logic/serif"),g=function(e){r.apply(this,arguments),this.serif=new l(u)};n.inherit(g,r),g.prototype.init=function(){r.prototype.init.apply(this,arguments),this.serif.init()},g.prototype.run=function(){r.prototype.run.apply(this,arguments),this.game.isKeyPush(o.BUTTON_Z)&&(this.serif.is_end()?this.game.notifyPrologue2Done():this.serif.next())},g.prototype.updateDisplay=function(){this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.save();var e=this.game.getImage("prologue2_bg");this.game.surface.drawImage(e,0,0,e.width,e.height,0,0,this.game.width,this.game.height),this.game.surface.restore();var t,i;if(this.serif.right_image()){this.game.surface.save(),t=h.PROLOGUE2_RIGHT_X,i=h.PROLOGUE2_RIGHT_Y,this.serif.is_right_talking()?(t-=a,i-=a):this.game.surface.globalAlpha=.5;var r=this.game.getImage(this.serif.right_image());this.game.surface.drawImage(r,t,i,r.width*s,r.height*s),this.game.surface.restore(),this.game.surface.save(),this.game.surface.globalAlpha=.5,this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.fillRect(440,420,100,40),this.game.surface.restore(),this.game.surface.save(),this.game.surface.font="24px 'Migu'",this.game.surface.textAlign="middle",this.game.surface.textBaseAlign="middle",this.game.surface.fillStyle="rgb( 255, 255, 255 )",this.serif.right_name()&&this.game.surface.fillText(this.serif.right_name(),450,450),this.game.surface.restore()}if(this.serif.left_image()){this.game.surface.save(),t=h.PROLOGUE2_LEFT_X,i=h.PROLOGUE2_LEFT_Y,this.serif.is_left_talking()?(t-=a,i-=a):this.game.surface.globalAlpha=.5;var n=this.game.getImage(this.serif.left_image());this.game.surface.transform(-1,0,0,1,n.width*s,0),this.game.surface.drawImage(n,t,i,n.width*s,n.height*s),this.game.surface.restore(),this.game.surface.save(),this.game.surface.globalAlpha=.5,this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.fillRect(100,420,100,40),this.game.surface.restore(),this.game.surface.save(),this.game.surface.font="24px 'Migu'",this.game.surface.textAlign="middle",this.game.surface.textBaseAlign="middle",this.game.surface.fillStyle="rgb( 255, 255, 255 )",this.serif.left_name()&&this.game.surface.fillText(this.serif.left_name(),120,450),this.game.surface.restore()}if(this.serif.serif_window()){this.game.surface.save(),t=h.PROLOGUE2_SERIF_WINDOW_X,i=h.PROLOGUE2_SERIF_WINDOW_Y;var o=this.game.getImage(this.serif.serif_window());this.serif.is_right_talking()&&(t=-t,this.game.surface.transform(-1,0,0,1,o.width*s,0)),this.game.surface.drawImage(o,t,i,o.width*s,o.height*s),this.game.surface.restore()}this.game.surface.save(),this.game.surface.font="18px 'Migu'",this.game.surface.textAlign="left",this.game.surface.textBaseAlign="middle",this.game.surface.fillStyle="rgb( 0, 0, 0 )";var u=this.serif.lines();if(u.length){i=80;for(var l=0,g=u.length;g>l;l++)this.game.surface.fillText(u[l],200,i),i+=30}this.game.surface.restore()},t.exports=g},{"../config":1,"../constant":2,"../logic/serif":4,"../serif/prologue2":11,"../util":12,"./base":6}],10:[function(e,t,i){"use strict";var s=e("./base"),a=e("../util"),r=e("../constant"),n=100,o=50,h=function(e){s.apply(this,arguments)};a.inherit(h,s),h.prototype.init=function(){s.prototype.init.apply(this,arguments)},h.prototype.run=function(){s.prototype.run.apply(this,arguments),this.game.isKeyPush(r.BUTTON_Z)&&(this.game.playSound("select"),this.game.notifyTitleDone())},h.prototype.updateDisplay=function(){this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.save(),this.frame_count<n?this.game.surface.globalAlpha=this.frame_count/n:this.game.surface.globalAlpha=1;var e=this.game.getImage("title_bg");this.game.surface.drawImage(e,0,0,e.width,e.height,0,0,this.game.width,this.game.height),this.game.surface.font="24px 'Migu'",this.game.surface.textAlign="center",this.game.surface.textBaseAlign="middle",this.game.surface.fillStyle="rgb( 0, 0, 0 )",Math.floor(this.frame_count/o)%2===0&&this.game.surface.fillText("Press Z to Start",450,350),this.game.surface.restore()},t.exports=h},{"../constant":2,"../util":12,"./base":6}],11:[function(e,t,i){"use strict";var s=[{serif:null,fukidashi:null,chara:"ganger",pos:"right",exp:"normal"},{serif:null,fukidashi:null,chara:"renko",pos:"left",exp:"normal"},{serif:"約束を守りなさい。\n早く博霊神社に行かないと。",fukidashi:"normal",chara:"ganger",pos:"right",exp:"normal"},{serif:"え、そんな約束してたっけ？",fukidashi:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:null,fukidashi:null,chara:"merry",pos:"right",exp:"normal"},{serif:"どうしたの？",fukidashi:"normal",chara:"merry",pos:"right",exp:"normal"},{serif:"実はかくかくしかじかで",fukidashi:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:"ふーん",fukidashi:"normal",chara:"merry",pos:"right",exp:"normal"},{serif:"約束といえば、前に博霊神社の\n入り口を調べようって\n約束してたわね。",fukidashi:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:"そうだっけ？",fukidashi:"normal",chara:"merry",pos:"right",exp:"normal"},{serif:"なんだか気になるわ。\nねえ、今から行ってみない？",fukidashi:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:"今から！？面倒だわ…。",fukidashi:"normal",chara:"merry",pos:"right",exp:"normal"},{serif:"そんな事言わずに\n行きましょうよ。",fukidashi:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:"うっ…急にめまいと\nフラつきと腹痛と頭痛が",fukidashi:"normal",chara:"merry",pos:"right",exp:"normal"},{serif:"さっきまで\n元気だったじゃない！",fukidashi:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:"うーん、気が進まないわ。",fukidashi:"normal",chara:"merry",pos:"right",exp:"normal"},{serif:"はぁ…。そんなに嫌なら\n仕方ないわね。\n私一人で行ってくるわ。",fukidashi:"normal",chara:"renko",pos:"left",exp:"normal"}];t.exports=s},{}],12:[function(e,t,i){"use strict";var s={inherit:function(e,t){var i=function(e){if(Object.create)return Object.create(e);var t=function(){};return t.prototype=e,new t};e.prototype=i(t.prototype),e.prototype.constructor=e}};t.exports=s},{}]},{},[5]);