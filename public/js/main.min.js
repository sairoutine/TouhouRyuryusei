!function t(e,i,n){function s(o,r){if(!i[o]){if(!e[o]){var u="function"==typeof require&&require;if(!r&&u)return u(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[o]={exports:{}};e[o][0].call(h.exports,function(t){var i=e[o][1][t];return s(i?i:t)},h,h.exports,t,e,i,n)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e,i){"use strict";var n={IMAGES:{title_bg:"image/title_bg.png"},SOUNDS:{select:{id:1,path:"sound/select.wav",volume:1}},BGMS:{title:{path:"bgm/title.mp3",volume:.4}}};n.ALL_MATERIAL_NUM=Object.keys(n.IMAGES).length+Object.keys(n.SOUNDS).length+Object.keys(n.BGMS).length,e.exports=n},{}],2:[function(t,e,i){"use strict";var n={DEBUG:!0,LOADING_SCENE:0,TITLE_SCENE:1,PROLOGUE_SCENE:2,STAGE_SCENE:3,EPILOGUE_SCENE:4,ENDING_SCENE:5,BUTTON_LEFT:1,BUTTON_UP:2,BUTTON_RIGHT:4,BUTTON_DOWN:8,BUTTON_Z:16,BUTTON_X:32,BUTTON_SHIFT:64,BUTTON_SPACE:128};e.exports=n},{}],3:[function(t,e,i){"use strict";var n=t("./config"),s=t("./constant"),a=t("./scene/loading"),o=t("./scene/title"),r=function(t){this.surface=t.getContext("2d"),this.width=Number(t.getAttribute("width")),this.height=Number(t.getAttribute("height")),this.state=null,this.scenes=[],this.scenes[s.LOADING_SCENE]=new a(this),this.scenes[s.TITLE_SCENE]=new o(this),this.images={},this.sounds={},this.bgms={},this.soundflag=0,this.frame_count=0,this.keyflag=0,this.before_keyflag=0};r.prototype={init:function(){this.frame_count=0,this.keyflag=0,this.before_keyflag=0,this.changeScene(s.LOADING_SCENE)},handleKeyDown:function(t){this.keyflag|=this._keyCodeToBitCode(t.keyCode),t.preventDefault()},handleKeyUp:function(t){this.keyflag&=~this._keyCodeToBitCode(t.keyCode),t.preventDefault()},isKeyDown:function(t){return this.keyflag&t},isKeyPush:function(t){return!(this.before_keyflag&t)&&this.keyflag&t},_keyCodeToBitCode:function(t){var e;switch(t){case 16:e=s.BUTTON_SHIFT;break;case 32:e=s.BUTTON_SPACE;break;case 37:e=s.BUTTON_LEFT;break;case 38:e=s.BUTTON_UP;break;case 39:e=s.BUTTON_RIGHT;break;case 40:e=s.BUTTON_DOWN;break;case 88:e=s.BUTTON_X;break;case 90:e=s.BUTTON_Z}return e},changeScene:function(t){this.state=t,this.currentScene().init()},playBGM:function(t){for(var e in this.bgms)this.bgms[e].pause(),this.bgms[e].currentTime=0;this.bgms[t].loop=!0,this.bgms[t].play()},playSound:function(t){this.soundflag|=n.SOUNDS[t].id},runPlaySound:function(){for(var t in n.SOUNDS)if(this.soundflag&n.SOUNDS[t].id){this.sounds[t].pause(),this.sounds[t].currentTime=0,this.sounds[t].play(),this.soundflag&=~n.SOUNDS[t].id;break}},getImage:function(t){return this.images[t]},currentScene:function(){return this.scenes[this.state]},run:function(){this.currentScene().run(),this.currentScene().updateDisplay(),this.runPlaySound(),this.before_keyflag=this.keyflag,this.frame_count++,requestAnimationFrame(this.run.bind(this))},notifyLoadingDone:function(){this.changeScene(s.TITLE_SCENE)}},e.exports=r},{"./config":1,"./constant":2,"./scene/loading":6,"./scene/title":7}],4:[function(t,e,i){"use strict";var n=t("./game");window.onload=function(){var t=document.getElementById("mainCanvas"),e=new n(t);e.init(),window.onkeydown=function(t){e.handleKeyDown(t)},window.onkeyup=function(t){e.handleKeyUp(t)},e.run()}},{"./game":3}],5:[function(t,e,i){"use strict";var n=function(t){this.game=t,this.frame_count=0};n.prototype.init=function(){this.frame_count=0},n.prototype.handleKeyDown=function(t){},n.prototype.handleKeyUp=function(t){},n.prototype.run=function(){this.frame_count++},n.prototype.updateDisplay=function(){console.error("updateDisplay method must be overridden")},e.exports=n},{}],6:[function(t,e,i){"use strict";var n=t("../util"),s=t("../config"),a=t("./base"),o=function(t){a.apply(this,arguments),this.loadedImageNum=0,this.loadedSoundNum=0,this.loadedBGMNum=0};n.inherit(o,a),o.prototype.init=function(){this._loadImages(),this._loadSounds(),this._loadBGMs()},o.prototype.loaded_material_num=function(){return this.loadedImageNum+this.loadedSoundNum+this.loadedBGMNum},o.prototype.run=function(){this.loaded_material_num()>=s.ALL_MATERIAL_NUM&&this.game.notifyLoadingDone()},o.prototype.updateDisplay=function(){var t=s.ALL_MATERIAL_NUM,e=this.loaded_material_num();this.game.surface.save(),this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.textAlign="right",this.game.surface.font="30px 'Comic Sans MS'",this.game.surface.fillText("Now Loading...",400,225),this.game.surface.fillText(e+"/"+t,400,285),this.game.surface.restore()},o.prototype._loadImages=function(){var t,e=this,i=function(){e.loadedImageNum++};for(var n in s.IMAGES)t=new Image,t.src=s.IMAGES[n],t.onload=i,this.game.images[n]=t},o.prototype._loadSounds=function(){var t,e,i=this,n=function(){i.loadedBGMNum++};for(var a in s.SOUNDS)t=s.SOUNDS[a],e=new Audio(t.path),e.volume=t.volume,e.addEventListener("canplay",n),e.load(),this.game.sounds[a]=e},o.prototype._loadBGMs=function(){var t,e,i=this,n=function(){i.loadedBGMNum++};for(var a in s.BGMS)t=s.BGMS[a],e=new Audio(t.path),e.volume=t.volume,e.addEventListener("canplay",n),e.load(),this.game.bgms[a]=e},e.exports=o},{"../config":1,"../util":8,"./base":5}],7:[function(t,e,i){"use strict";var n=t("./base"),s=t("../util"),a=t("../constant"),o=100,r=50,u=function(t){n.apply(this,arguments)};s.inherit(u,n),u.prototype.init=function(){n.prototype.init.apply(this,arguments)},u.prototype.run=function(){n.prototype.run.apply(this,arguments),this.game.isKeyPush(a.BUTTON_Z)&&(this.game.playSound("select"),this.game.notifyOpeningDone())},u.prototype.updateDisplay=function(){this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.save(),this.frame_count<o?this.game.surface.globalAlpha=this.frame_count/o:this.game.surface.globalAlpha=1;var t=this.game.getImage("title_bg");this.game.surface.drawImage(t,0,0,t.width,t.height,0,0,this.game.width,this.game.height),this.game.surface.font="24px 'Comic Sans MS'",this.game.surface.textAlign="center",this.game.surface.textBaseAlign="middle",this.game.surface.fillStyle="rgb( 0, 0, 0 )",Math.floor(this.frame_count/r)%2===0&&this.game.surface.fillText("Press Z to Start",450,350),this.game.surface.restore()},e.exports=u},{"../constant":2,"../util":8,"./base":5}],8:[function(t,e,i){"use strict";var n={inherit:function(t,e){var i=function(t){if(Object.create)return Object.create(t);var e=function(){};return e.prototype=t,new e};t.prototype=i(e.prototype),t.prototype.constructor=t}};e.exports=n},{}]},{},[4]);