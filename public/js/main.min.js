!function e(t,i,s){function a(r,o){if(!i[r]){if(!t[r]){var h="function"==typeof require&&require;if(!o&&h)return h(r,!0);if(n)return n(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var l=i[r]={exports:{}};t[r][0].call(l.exports,function(e){var i=t[r][1][e];return a(i?i:e)},l,l.exports,e,t,i,s)}return i[r].exports}for(var n="function"==typeof require&&require,r=0;r<s.length;r++)a(s[r]);return a}({1:[function(e,t,i){"use strict";var s={IMAGES:{title_bg:"image/title_bg.png",prologue1_1_bg:"image/prologue_bg.png",prologue2_bg:"image/prologue_bg.png",renko_normal:"image/renko_normal.png",merry_normal:"image/merry_normal.png",aya_normal:"image/aya_normal.png",ganger_normal:"image/ganger_normal.png",logo:"image/logo.png",serif_window:"image/serif.png"},SOUNDS:{select:{id:1,path:"sound/select.wav",volume:.8}},BGMS:{title:{path:"bgm/title.mp3",volume:.4},prologue1:{path:"bgm/prologue.mp3",volume:.4},prologue2:{path:"bgm/prologue.mp3",volume:.4}},MESSAGE_SPEED:10,PROLOGUE2_LEFT_X:0,PROLOGUE2_LEFT_Y:132,PROLOGUE2_RIGHT_X:283,PROLOGUE2_RIGHT_Y:132,CHARA:{ganger:{name:"？？？"},renko:{name:"蓮子"},merry:{name:"メリー"}}};s.ALL_MATERIAL_NUM=Object.keys(s.IMAGES).length+Object.keys(s.SOUNDS).length+Object.keys(s.BGMS).length,t.exports=s},{}],2:[function(e,t,i){"use strict";var s={DEBUG:!0,LOADING_SCENE:0,TITLE_SCENE:1,PROLOGUE1_SCENE:2,PROLOGUE2_SCENE:3,STAGE_SCENE:4,EPILOGUE_SCENE:5,ENDING_SCENE:6,BUTTON_LEFT:1,BUTTON_UP:2,BUTTON_RIGHT:4,BUTTON_DOWN:8,BUTTON_Z:16,BUTTON_X:32,BUTTON_SHIFT:64,BUTTON_SPACE:128};t.exports=s},{}],3:[function(e,t,i){"use strict";var s,a=e("./config"),n=e("./constant"),r=e("./scene/loading"),o=e("./scene/title"),h=e("./scene/prologue1"),u=e("./scene/prologue2"),l=function(e){this.surface=e.getContext("2d"),this.width=Number(e.getAttribute("width")),this.height=Number(e.getAttribute("height")),this.state=null,this.scenes=[],this.scenes[n.LOADING_SCENE]=new r(this),this.scenes[n.TITLE_SCENE]=new o(this),this.scenes[n.PROLOGUE1_SCENE]=new h(this),this.scenes[n.PROLOGUE2_SCENE]=new u(this),this.images={},this.sounds={},this.bgms={},this.soundflag=0,this.frame_count=0,this.keyflag=0,this.before_keyflag=0};l.prototype={init:function(){this.frame_count=0,this.keyflag=0,this.before_keyflag=0,this.changeScene(n.LOADING_SCENE)},handleKeyDown:function(e){this.keyflag|=this._keyCodeToBitCode(e.keyCode),e.preventDefault()},handleKeyUp:function(e){this.keyflag&=~this._keyCodeToBitCode(e.keyCode),e.preventDefault()},isKeyDown:function(e){return this.keyflag&e},isKeyPush:function(e){return!(this.before_keyflag&e)&&this.keyflag&e},_keyCodeToBitCode:function(e){var t;switch(e){case 16:t=n.BUTTON_SHIFT;break;case 32:t=n.BUTTON_SPACE;break;case 37:t=n.BUTTON_LEFT;break;case 38:t=n.BUTTON_UP;break;case 39:t=n.BUTTON_RIGHT;break;case 40:t=n.BUTTON_DOWN;break;case 88:t=n.BUTTON_X;break;case 90:t=n.BUTTON_Z}return t},changeScene:function(e){this.state=e,this.currentScene().init()},playBGM:function(e){for(var t in this.bgms)this.bgms[t].pause(),this.bgms[t].currentTime=0;this.bgms[e].loop=!0,this.bgms[e].play()},playSound:function(e){this.soundflag|=a.SOUNDS[e].id},runPlaySound:function(){for(var e in a.SOUNDS)if(this.soundflag&a.SOUNDS[e].id){this.sounds[e].pause(),this.sounds[e].currentTime=0,this.sounds[e].play(),this.soundflag&=~a.SOUNDS[e].id;break}},getImage:function(e){return this.images[e]},currentScene:function(){return this.scenes[this.state]},run:function(){this.currentScene().run(),this.currentScene().updateDisplay(),this.runPlaySound(),this.before_keyflag=this.keyflag,this.frame_count++,requestAnimationFrame(this.run.bind(this))},notifyLoadingDone:function(){this.changeScene(n.DEBUG&&s?s:n.TITLE_SCENE)},notifyTitleDone:function(){this.changeScene(n.PROLOGUE1_SCENE)},notifyPrologue1Done:function(){this.changeScene(n.PROLOGUE2_SCENE)},notifyPrologue2Done:function(){this.changeScene(n.STAGE_SCENE)}},t.exports=l},{"./config":1,"./constant":2,"./scene/loading":7,"./scene/prologue1":8,"./scene/prologue2":9,"./scene/title":10}],4:[function(e,t,i){"use strict";var s=e("../config"),a=function(e){this.timeoutID=null,this.script=e,this.progress=null,this.left_chara_id=null,this.left_exp=null,this.right_chara_id=null,this.right_exp=null,this.pos=null,this.line_num=0,this.printing_lines=[]};a.prototype.init=function(){this.progress=-1,this.timeoutID=null,this.left_chara_id=null,this.left_exp=null,this.right_chara_id=null,this.right_exp=null,this.pos=null,this.line_num=0,this.printing_lines=[],this.next()},a.prototype.is_end=function(){return this.progress+1===this.script.length},a.prototype.next=function(){this.progress++;var e=this.script[this.progress];this._showChara(e),e.serif?this._printMessage(e.serif):this.next()},a.prototype._showChara=function(e){e.pos&&(this.pos=e.pos,"left"===e.pos?(this.left_chara_id=e.chara,this.left_exp=e.exp):"right"===e.pos&&(this.right_chara_id=e.chara,this.right_exp=e.exp))},a.prototype._printMessage=function(e){var t=this;null!==t.timeoutID&&(clearTimeout(t.timeoutID),t.timeoutID=null);var i=e.split(""),a=i.length,n=0;t.line_num=0,t.printing_lines=[];var r=function(){if(!(n>=a)){var e=s.MESSAGE_SPEED,o=i[n];n++,"\n"===o?t.line_num++:(t.printing_lines[t.line_num]||(t.printing_lines[t.line_num]=""),t.printing_lines[t.line_num]=t.printing_lines[t.line_num]+o),t.timeoutID=setTimeout(r,e)}};r()},a.prototype.right_image=function(){return this.right_chara_id?this.right_chara_id+"_"+this.right_exp:null},a.prototype.left_image=function(){return this.left_chara_id?this.left_chara_id+"_"+this.left_exp:null},a.prototype.text_name=function(){return this.is_left_talking()?s.CHARA[this.left_chara_id].name:this.is_right_talking()?s.CHARA[this.right_chara_id].name:void 0},a.prototype.is_left_talking=function(){return"left"===this.pos?!0:!1},a.prototype.is_right_talking=function(){return"right"===this.pos?!0:!1},a.prototype.lines=function(){return this.printing_lines},t.exports=a},{"../config":1}],5:[function(e,t,i){"use strict";var s=e("./game");window.onload=function(){var e=document.getElementById("mainCanvas"),t=new s(e);t.init(),window.onkeydown=function(e){t.handleKeyDown(e)},window.onkeyup=function(e){t.handleKeyUp(e)},t.run()}},{"./game":3}],6:[function(e,t,i){"use strict";var s=function(e){this.game=e,this.frame_count=0};s.prototype.init=function(){this.frame_count=0},s.prototype.handleKeyDown=function(e){},s.prototype.handleKeyUp=function(e){},s.prototype.run=function(){this.frame_count++},s.prototype.updateDisplay=function(){console.error("updateDisplay method must be overridden")},t.exports=s},{}],7:[function(e,t,i){"use strict";var s=e("../util"),a=e("../config"),n=e("./base"),r=function(e){n.apply(this,arguments),this.loadedImageNum=0,this.loadedSoundNum=0,this.loadedBGMNum=0};s.inherit(r,n),r.prototype.init=function(){this._loadImages(),this._loadSounds(),this._loadBGMs()},r.prototype.loaded_material_num=function(){return this.loadedImageNum+this.loadedSoundNum+this.loadedBGMNum},r.prototype.run=function(){this.loaded_material_num()>=a.ALL_MATERIAL_NUM&&this.game.notifyLoadingDone()},r.prototype.updateDisplay=function(){var e=a.ALL_MATERIAL_NUM,t=this.loaded_material_num();this.game.surface.save(),this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.textAlign="right",this.game.surface.font="30px 'Migu'",this.game.surface.fillText("Now Loading...",400,225),this.game.surface.fillText(t+"/"+e,400,285),this.game.surface.restore()},r.prototype._loadImages=function(){var e,t=this,i=function(){t.loadedImageNum++};for(var s in a.IMAGES)e=new Image,e.src=a.IMAGES[s],e.onload=i,this.game.images[s]=e},r.prototype._loadSounds=function(){var e,t,i=this,s=function(){i.loadedBGMNum++};for(var n in a.SOUNDS)e=a.SOUNDS[n],t=new Audio(e.path),t.volume=e.volume,t.addEventListener("canplay",s),t.load(),this.game.sounds[n]=t},r.prototype._loadBGMs=function(){var e,t,i=this,s=function(){i.loadedBGMNum++};for(var n in a.BGMS)e=a.BGMS[n],t=new Audio(e.path),t.volume=e.volume,t.addEventListener("canplay",s),t.load(),this.game.bgms[n]=t},t.exports=r},{"../config":1,"../util":12,"./base":6}],8:[function(e,t,i){"use strict";var s=function(){}.toString().match(/[^]*\/\*([^]*)\*\/\}$/)[1],a=e("./base"),n=e("../util"),r=(e("../constant"),e("../config"),300),o=function(e){a.apply(this,arguments)};n.inherit(o,a),o.prototype.init=function(){a.prototype.init.apply(this,arguments)},o.prototype.run=function(){a.prototype.run.apply(this,arguments),r+60<this.frame_count&&this.game.notifyPrologue1Done()},o.prototype.updateDisplay=function(){this.game.surface.clearRect(0,0,this.game.width,this.game.height);var e=this.game.getImage("prologue1_1_bg");this.game.surface.drawImage(e,0,0,e.width,e.height,0,0,this.game.width,this.game.height),this.game.surface.save();var t=1;if(this.frame_count<r/3?t=3*this.frame_count/r:r/3<this.frame_count&&this.frame_count<2*r/3?t=1:2*r/3<this.frame_count&&(t=3*(r-this.frame_count)/r),this.game.surface.globalAlpha=t,r>this.frame_count){this.game.surface.font="24px 'Migu'",this.game.surface.textBaseAlign="middle",this.game.surface.fillStyle="rgb( 255, 255, 255 )";var i=s.split("\n");if(i.length)for(var a=50,n=0,o=i.length;o>n;n++)this.game.surface.fillText(i[n],50,a),a+=30}this.game.surface.restore()},t.exports=o},{"../config":1,"../constant":2,"../util":12,"./base":6}],9:[function(e,t,i){"use strict";var s=.5,a=e("./base"),n=e("../util"),r=e("../constant"),o=e("../config"),h=e("../serif/prologue2"),u=e("../logic/serif"),l=function(e){a.apply(this,arguments),this.serif=new u(h)};n.inherit(l,a),l.prototype.init=function(){a.prototype.init.apply(this,arguments),this.serif.init()},l.prototype.run=function(){a.prototype.run.apply(this,arguments),this.game.isKeyPush(r.BUTTON_Z)&&(this.serif.is_end()?this.game.notifyPrologue2Done():this.serif.next())},l.prototype.updateDisplay=function(){this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.save();var e=this.game.getImage("prologue2_bg");if(this.game.surface.drawImage(e,0,0,e.width,e.height,0,0,this.game.width,this.game.height),this.game.surface.restore(),this.serif.right_image()){this.game.surface.save(),this.serif.is_right_talking()||(this.game.surface.globalAlpha=.5);var t=this.game.getImage(this.serif.right_image());this.game.surface.drawImage(t,o.PROLOGUE2_RIGHT_X,o.PROLOGUE2_RIGHT_Y,t.width*s,t.height*s),this.game.surface.restore()}if(this.serif.left_image()){this.game.surface.save(),this.serif.is_left_talking()||(this.game.surface.globalAlpha=.5);var i=this.game.getImage(this.serif.left_image());this.game.surface.drawImage(i,o.PROLOGUE2_LEFT_X,o.PROLOGUE2_LEFT_Y,i.width*s,i.height*s),this.game.surface.restore()}this.game.surface.save(),this.game.surface.globalAlpha=.5,this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.fillRect(5,345,630,125),this.game.surface.restore(),this.game.surface.save(),this.game.surface.globalAlpha=.5,this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.fillRect(5,305,100,40),this.game.surface.restore(),this.game.surface.save(),this.game.surface.font="24px 'Migu'",this.game.surface.textAlign="left",this.game.surface.textBaseAlign="middle",this.game.surface.fillStyle="rgb( 255, 255, 255 )",this.serif.text_name()&&this.game.surface.fillText(this.serif.text_name(),15,340);var a=this.serif.lines();if(a.length)for(var n=380,r=0,h=a.length;h>r;r++)this.game.surface.fillText(a[r],15,n),n+=30;this.game.surface.restore()},t.exports=l},{"../config":1,"../constant":2,"../logic/serif":4,"../serif/prologue2":11,"../util":12,"./base":6}],10:[function(e,t,i){"use strict";var s=e("./base"),a=e("../util"),n=e("../constant"),r=100,o=50,h=function(e){s.apply(this,arguments)};a.inherit(h,s),h.prototype.init=function(){s.prototype.init.apply(this,arguments)},h.prototype.run=function(){s.prototype.run.apply(this,arguments),this.game.isKeyPush(n.BUTTON_Z)&&(this.game.playSound("select"),this.game.notifyTitleDone())},h.prototype.updateDisplay=function(){this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.save(),this.frame_count<r?this.game.surface.globalAlpha=this.frame_count/r:this.game.surface.globalAlpha=1;var e=this.game.getImage("title_bg");this.game.surface.drawImage(e,0,0,e.width,e.height,0,0,this.game.width,this.game.height),this.game.surface.font="24px 'Migu'",this.game.surface.textAlign="center",this.game.surface.textBaseAlign="middle",this.game.surface.fillStyle="rgb( 0, 0, 0 )",Math.floor(this.frame_count/o)%2===0&&this.game.surface.fillText("Press Z to Start",450,350),this.game.surface.restore()},t.exports=h},{"../constant":2,"../util":12,"./base":6}],11:[function(e,t,i){"use strict";var s=[{serif:"今日は8月31日。",fukidash:null,chara:null,pos:null,exp:null},{serif:null,fukidash:null,chara:"ganger",pos:"right",exp:"normal"},{serif:null,fukidash:null,chara:"renko",pos:"left",exp:"normal"},{serif:"約束を守りなさい。早く博霊神社に行かないと。",fukidash:"normal",chara:"ganger",pos:"right",exp:"normal"},{serif:"え、そんな約束してたっけ？",fukidash:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:null,fukidash:null,chara:"merry",pos:"right",exp:"normal"},{serif:"どうしたの？",fukidash:"normal",chara:"merry",pos:"right",exp:"normal"},{serif:"実はかくかくしかじかで",fukidash:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:"ふーん",fukidash:"normal",chara:"merry",pos:"right",exp:"normal"},{serif:"約束といえば、前に博霊神社の入り口を\n調べようって約束してたわね。",fukidash:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:"そうだっけ？",fukidash:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:"なんだか気になるわ。ねえ、今から行ってみない？",fukidash:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:"今から！？面倒だわ…。",fukidash:"normal",chara:"merry",pos:"right",exp:"normal"},{serif:"そんな事言わずに行きましょうよ。",fukidash:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:"うっ…急にめまいとフラつきと腹痛と頭痛が",fukidash:"normal",chara:"merry",pos:"right",exp:"normal"},{serif:"さっきまで元気だったじゃない！",fukidash:"normal",chara:"renko",pos:"left",exp:"normal"},{serif:"うーん、気が進まないわ。",fukidash:"normal",chara:"merry",pos:"right",exp:"normal"},{serif:"はぁ…。そんなに嫌なら仕方ないわね。\n私一人で行ってくるわ。",fukidash:"normal",chara:"renko",pos:"left",exp:"normal"}];t.exports=s},{}],12:[function(e,t,i){"use strict";var s={inherit:function(e,t){var i=function(e){if(Object.create)return Object.create(e);var t=function(){};return t.prototype=e,new t};e.prototype=i(t.prototype),e.prototype.constructor=e}};t.exports=s},{}]},{},[5]);