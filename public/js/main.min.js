!function t(e,n,i){function o(a,r){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!r&&u)return u(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(t){var n=e[a][1][t];return o(n?n:t)},h,h.exports,t,e,n,i)}return n[a].exports}for(var s="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(t,e,n){"use strict";var i={};e.exports=i},{}],2:[function(t,e,n){"use strict";var i={DEBUG:!0,LOADING_SCENE:0,TITLE_SCENE:1,PROLOGUE_SCENE:2,STAGE_SCENE:3,EPILOGUE_SCENE:4,ENDING_SCENE:5,BUTTON_LEFT:1,BUTTON_UP:2,BUTTON_RIGHT:4,BUTTON_DOWN:8,BUTTON_Z:16,BUTTON_X:32,BUTTON_SHIFT:64,BUTTON_SPACE:128,IMAGES:{},SOUNDS:{},BGMS:{}};i.ALL_MATERIAL_NUM=Object.keys(i.IMAGES).length+Object.keys(i.SOUNDS).length+Object.keys(i.BGMS).length,e.exports=i},{}],3:[function(t,e,n){"use strict";var i=t("./config"),o=t("./constant"),s=t("./scene/loading"),a=function(t){this.surface=t.getContext("2d"),this.width=Number(t.getAttribute("width")),this.height=Number(t.getAttribute("height")),this.state=null,this.scenes=[],this.scenes[o.LOADING_SCENE]=new s(this),this.images={},this.sounds={},this.bgms={},this.soundflag=0,this.frame_count=0,this.keyflag=0,this.before_keyflag=0};a.prototype={init:function(){this.frame_count=0,this.keyflag=0,this.before_keyflag=0,this.changeScene(o.LOADING_SCENE)},handleKeyDown:function(t){this.keyflag|=this._keyCodeToBitCode(t.keyCode),t.preventDefault()},handleKeyUp:function(t){this.keyflag&=~this._keyCodeToBitCode(t.keyCode),t.preventDefault()},isKeyDown:function(t){return this.keyflag&t},isKeyPush:function(t){return!(this.before_keyflag&t)&&this.keyflag&t},_keyCodeToBitCode:function(t){var e;switch(t){case 16:e=o.BUTTON_SHIFT;break;case 32:e=o.BUTTON_SPACE;break;case 37:e=o.BUTTON_LEFT;break;case 38:e=o.BUTTON_UP;break;case 39:e=o.BUTTON_RIGHT;break;case 40:e=o.BUTTON_DOWN;break;case 88:e=o.BUTTON_X;break;case 90:e=o.BUTTON_Z}return e},changeScene:function(t){this.state=t,this.currentScene().init()},playBGM:function(t){for(var e in this.bgms)this.bgms[e].pause(),this.bgms[e].currentTime=0;this.bgms[t].loop=!0,this.bgms[t].play()},playSound:function(t){this.soundflag|=i.SOUNDS[t].id},runPlaySound:function(){for(var t in i.SOUNDS)if(this.soundflag&i.SOUNDS[t].id){this.sounds[t].pause(),this.sounds[t].currentTime=0,this.sounds[t].play(),this.soundflag&=~i.SOUNDS[t].id;break}},getImage:function(t){return this.images[t]},currentScene:function(){return this.scenes[this.state]},run:function(){this.currentScene().run(),this.currentScene().updateDisplay(),this.runPlaySound(),this.before_keyflag=this.keyflag,this.frame_count++,requestAnimationFrame(this.run.bind(this))}},e.exports=a},{"./config":1,"./constant":2,"./scene/loading":6}],4:[function(t,e,n){"use strict";var i=t("./game");window.onload=function(){var t=document.getElementById("mainCanvas"),e=new i(t);e.init(),window.onkeydown=function(t){e.handleKeyDown(t)},window.onkeyup=function(t){e.handleKeyUp(t)},e.run()}},{"./game":3}],5:[function(t,e,n){"use strict";var i=function(t){this.game=t,this.frame_count=0};i.prototype.init=function(){this.frame_count=0},i.prototype.handleKeyDown=function(t){},i.prototype.handleKeyUp=function(t){},i.prototype.run=function(){this.frame_count++},i.prototype.updateDisplay=function(){console.error("updateDisplay method must be overridden")},e.exports=i},{}],6:[function(t,e,n){"use strict";var i=t("../util"),o=t("../constant"),s=t("./base"),a=function(t){s.apply(this,arguments),this.loadedImageNum=0,this.loadedSoundNum=0,this.loadedBGMNum=0};i.inherit(a,s),a.prototype.init=function(){this._loadImages(),this._loadSounds(),this._loadBGMs()},a.prototype.loaded_material_num=function(){return this.loadedImageNum+this.loadedSoundNum+this.loadedBGMNum},a.prototype.run=function(){this.loaded_material_num()>=o.ALL_MATERIAL_NUM},a.prototype.updateDisplay=function(){var t=o.ALL_MATERIAL_NUM,e=this.loaded_material_num();this.game.surface.save(),this.game.surface.clearRect(0,0,this.game.width,this.game.height),this.game.surface.fillStyle="rgb( 0, 0, 0 )",this.game.surface.textAlign="right",this.game.surface.font="30px 'ＭＳ ゴシック'",this.game.surface.fillText("Now Loading...",400,225),this.game.surface.fillText(e+"/"+t,400,285),this.game.surface.restore()},a.prototype._loadImages=function(){var t,e=this,n=function(){e.loadedImageNum++};for(var i in o.IMAGES)t=new Image,t.src=this.game.IMAGES[i],t.onload=n,this.game.images[i]=t},a.prototype._loadSounds=function(){var t,e,n=this,i=function(){n.loadedBGMNum++};for(var s in o.SOUNDS)t=o.SOUNDS[s],e=new Audio(t.path),e.volume=t.volume,e.addEventListener("canplay",i),e.load(),this.game.sounds[s]=e},a.prototype._loadBGMs=function(){var t,e,n=this,i=function(){n.loadedBGMNum++};for(var s in o.BGMS)t=o.BGMS[s],e=new Audio(t.path),e.volume=t.volume,e.addEventListener("canplay",i),e.load(),this.game.bgms[s]=e},e.exports=a},{"../constant":2,"../util":7,"./base":5}],7:[function(t,e,n){"use strict";var i={inherit:function(t,e){var n=function(t){if(Object.create)return Object.create(t);var e=function(){};return e.prototype=t,new e};t.prototype=n(e.prototype),t.prototype.constructor=t}};e.exports=i},{}]},{},[4]);